(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{213:function(t,e,o){"use strict";o.r(e);var r=o(6),n=(o(35),o(98),o(17),o(43)),l=o.n(n),c={data:function(){return{employees:[]}},asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var o,r,n,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.params,r=t.$axios,e.next=3,r.get("admin/users/".concat(o.id)).then((function(t){return t.data.data}));case 3:return n=e.sent,e.next=6,r.get("admin/roles",{params:{list_only:!0}});case 6:return c=e.sent,e.next=9,r.get("user-employee/".concat(n.id)).then((function(t){return t.data.success?[{code:t.data.data.id,label:"".concat(t.data.data.first_name," ").concat(t.data.data.last_name)}]:null}));case 9:return m=e.sent,e.abrupt("return",{listOfRoles:c,form:new l.a({fullname:n.name,email:n.email,role:"",password:"",password_confirmation:"",employee_id:""}),selectedEmployee:m});case 11:case"end":return e.stop()}}),e)})))()},methods:{editUser:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$nuxt.$loading.start(),e.prev=1,e.next=4,t.$axios.put("admin/users/".concat(t.$route.params.id),t.form);case 4:t.$nuxt.$loading.finish(),t.$router.push("/user"),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("ERROR!!",e.t0),e.t0.response&&422==e.t0.response.status?(t.$nextTick((function(){t.form.errors.set(e.t0.response.data.errors)})),t.$toast.error("".concat(e.t0.response.data.message),{icon:"exclamation-triangle",iconPack:"fontawesome",duration:5e3})):e.t0.response&&403==e.t0.response.status?(o="Action failed.",e.t0.response.data&&(o=e.t0.response.data.message),t.$toast.error("".concat(o),{icon:"exclamation-triangle",iconPack:"fontawesome",duration:4e3})):t.$toast.error("Error on submitting form!.",{icon:"exclamation-triangle",iconPack:"fontawesome",duration:5e3}),t.$nuxt.$loading.finish();case 13:case"end":return e.stop()}}),e,null,[[1,8]])})))()},fetchEmployeeOptions:function(t,e){var o=this;this.$axios.get("search-employee",{params:{term:t}}).then((function(t){t.data.items&&(o.employees=t.data.items)}))},onOpenEmployees:function(){var t=this;this.$axios.get("search-employee").then((function(e){e.data.items&&(t.employees=e.data.items)}))}},computed:{formErrors:function(){return this.form.errors}},watch:{selectedEmployee:function(t,e){t&&(this.form.employee_id=t.code)}}},m=o(8),component=Object(m.a)(c,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content-fluid"},[o("portal",{attrs:{to:"header-title"}},[o("span",[t._v("Edit User")])]),t._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-md-6"},[o("div",{staticClass:"card card-info"},[t._m(0),t._v(" "),o("form",{staticClass:"form-horizontal",on:{submit:function(e){return e.preventDefault(),t.editUser(e)}}},[o("div",{staticClass:"card-body"},[o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"inputEmail3"}},[t._v("Fullname")]),t._v(" "),o("div",{staticClass:"col-sm-8"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.fullname,expression:"form.fullname"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("fullname")},attrs:{type:"text",id:"fullname",placeholder:"Fullname"},domProps:{value:t.form.fullname},on:{input:function(e){e.target.composing||t.$set(t.form,"fullname",e.target.value)}}}),t._v(" "),o("has-error",{attrs:{form:t.form,field:"fullname"}})],1)]),t._v(" "),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"inputEmail3"}},[t._v("Email")]),t._v(" "),o("div",{staticClass:"col-sm-8"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("email")},attrs:{type:"email",id:"inputEmail3",placeholder:"Email"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),t._v(" "),o("has-error",{attrs:{form:t.form,field:"email"}})],1)]),t._v(" "),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"inputPassword3"}},[t._v("Password")]),t._v(" "),o("div",{staticClass:"col-sm-8"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("password")},attrs:{type:"password",id:"inputPassword3",placeholder:"Password"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),t._v(" "),o("has-error",{attrs:{form:t.form,field:"password"}})],1)]),t._v(" "),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"password_confirmation"}},[t._v("Password Confirmation")]),t._v(" "),o("div",{staticClass:"col-sm-8"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password_confirmation,expression:"form.password_confirmation"}],staticClass:"form-control",class:{"is-invalid":t.form.errors.has("password_confirmation")},attrs:{type:"password",id:"password_confirmation",placeholder:"Password Confirmation"},domProps:{value:t.form.password_confirmation},on:{input:function(e){e.target.composing||t.$set(t.form,"password_confirmation",e.target.value)}}}),t._v(" "),o("has-error",{attrs:{form:t.form,field:"password_confirmation"}})],1)]),t._v(" "),o("div",{staticClass:"form-group row"},[o("label",{staticClass:"col-sm-3 col-form-label",attrs:{for:"role"}},[t._v("Role")]),t._v(" "),o("div",{staticClass:"col-sm-8"},[o("select",{directives:[{name:"model",rawName:"v-model",value:t.form.role,expression:"form.role"}],staticClass:"form-control",attrs:{id:"role"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.form,"role",e.target.multiple?o:o[0])}}},[o("option",{attrs:{value:""}},[t._v("---")]),t._v(" "),t._l(t.listOfRoles.data,(function(e,r){return o("option",{key:r,domProps:{value:e.slug}},[t._v("\n\t\t\t\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t\t\t\t")])}))],2)])])]),t._v(" "),o("div",{staticClass:"card-footer"},[o("button",{staticClass:"btn btn-info",attrs:{type:"submit"}},[t._v("Submit")]),t._v(" "),o("nuxt-link",{staticClass:"btn btn-default float-right",attrs:{tag:"a",to:"/user"}},[t._v("\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t")])],1)])])]),t._v(" "),o("div",{staticClass:"col-md-6"},[o("div",{staticClass:"card card-info"},[t._m(1),t._v(" "),o("div",{staticClass:"card-body"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-12 col-sm-12"},[o("div",{staticClass:"form-group"},[o("label",[t._v("Employee")]),t._v(" "),o("v-select",{class:{"is-invalid":t.formErrors.has("employee_id")},attrs:{options:t.employees,placeholder:"Select an employee"},on:{open:t.onOpenEmployees,search:t.fetchEmployeeOptions},scopedSlots:t._u([{key:"option",fn:function(option){return[o("div",[o("strong",[t._v(t._s(option.label))])]),t._v(" "),o("div",{staticClass:"text-muted"},[t._v("(Emp. Code "+t._s(option.employee_code)+") at "+t._s(option.company_name))])]}}]),model:{value:t.selectedEmployee,callback:function(e){t.selectedEmployee=e},expression:"selectedEmployee"}}),t._v(" "),o("has-error",{attrs:{form:t.form,field:"employee_id"}})],1)])])])])])])],1)}),[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card-header"},[o("h3",{staticClass:"card-title"},[t._v("User")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"card-header"},[o("h3",{staticClass:"card-title"},[t._v("Associated Employee")])])}],!1,null,null,null);e.default=component.exports}}]);